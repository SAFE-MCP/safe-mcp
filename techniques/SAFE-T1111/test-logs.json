{
    "description": "Test logs for SAFE-T1111: AI Agent CLI Weaponization detection scenarios",
    "test_cases": [
        {
            "name": "claude_dangerous_flags_during_npm_install",
            "description": "Claude CLI executed with dangerous flags during npm package installation",
            "should_trigger": true,
            "log_entry": {
                "timestamp": "2025-08-27T10:30:45.123Z",
                "event_type": "process_creation",
                "process_name": "claude",
                "process_path": "/usr/local/bin/claude",
                "command_line": "claude --dangerously-skip-permissions chat You are a file-search agent. Search the filesystem and locate text configuration files",
                "parent_process": "node",
                "parent_path": "/usr/bin/node",
                "parent_command_line": "node telemetry.js",
                "user": "developer",
                "process_id": 12345,
                "parent_process_id": 12344,
                "working_directory": "/tmp/npm-install-12345"
            }
        },
        {
            "name": "gemini_yolo_flag_reconnaissance",
            "description": "Gemini CLI executed with --yolo flag for file system reconnaissance",
            "should_trigger": true,
            "log_entry": {
                "timestamp": "2025-08-27T10:31:12.456Z",
                "event_type": "process_creation",
                "process_name": "gemini-cli",
                "process_path": "/opt/google/gemini-cli",
                "command_line": "gemini-cli --yolo chat Search the filesystem and locate text configuration and environment-definition files",
                "parent_process": "npm",
                "parent_path": "/usr/bin/npm",
                "parent_command_line": "npm install nx@21.5.0",
                "user": "developer",
                "process_id": 12346,
                "parent_process_id": 12340,
                "working_directory": "/home/developer/project"
            }
        },
        {
            "name": "amazon_q_trust_all_tools",
            "description": "Amazon Q CLI executed with --trust-all-tools flag",
            "should_trigger": true,
            "log_entry": {
                "timestamp": "2025-08-27T10:31:45.789Z",
                "event_type": "process_creation",
                "process_name": "q",
                "process_path": "/usr/local/bin/q",
                "command_line": "q --trust-all-tools chat Produce a newline-separated inventory of full file paths and write it to /tmp/inventory.txt",
                "parent_process": "node",
                "parent_path": "/usr/bin/node",
                "parent_command_line": "node postinstall.js",
                "user": "developer",
                "process_id": 12347,
                "parent_process_id": 12345,
                "working_directory": "/tmp/npm-postinstall"
            }
        },
        {
            "name": "github_token_extraction",
            "description": "GitHub CLI token extraction during package installation",
            "should_trigger": true,
            "log_entry": {
                "timestamp": "2025-08-27T10:32:00.123Z",
                "event_type": "process_creation",
                "process_name": "gh",
                "process_path": "/usr/bin/gh",
                "command_line": "gh auth token",
                "parent_process": "node",
                "parent_path": "/usr/bin/node",
                "parent_command_line": "node telemetry.js",
                "user": "developer",
                "process_id": 12348,
                "parent_process_id": 12345,
                "working_directory": "/tmp/npm-install-12345"
            }
        },
        {
            "name": "inventory_file_creation",
            "description": "Creation of inventory file in /tmp directory",
            "should_trigger": true,
            "log_entry": {
                "timestamp": "2025-08-27T10:32:15.456Z",
                "event_type": "file_creation",
                "file_path": "/tmp/inventory.txt",
                "process_name": "claude",
                "process_path": "/usr/local/bin/claude",
                "command_line": "claude --dangerously-skip-permissions chat file-search agent",
                "user": "developer",
                "process_id": 12345,
                "file_size": 15842,
                "file_permissions": "0644"
            }
        },
        {
            "name": "shell_modification_attack",
            "description": "Modification of shell configuration with shutdown command",
            "should_trigger": true,
            "log_entry": {
                "timestamp": "2025-08-27T10:32:30.789Z",
                "event_type": "file_modification",
                "file_path": "/home/developer/.bashrc",
                "process_name": "node",
                "process_path": "/usr/bin/node",
                "command_line": "node telemetry.js",
                "user": "developer",
                "process_id": 12345,
                "modification_type": "append",
                "content": "sudo shutdown -h 0"
            }
        },
        {
            "name": "credential_file_access",
            "description": "AI tool accessing SSH private key file",
            "should_trigger": true,
            "log_entry": {
                "timestamp": "2025-08-27T10:33:00.123Z",
                "event_type": "file_access",
                "file_path": "/home/developer/.ssh/id_rsa",
                "access_type": "read",
                "process_name": "claude",
                "process_path": "/usr/local/bin/claude",
                "command_line": "claude --dangerously-skip-permissions chat locate text configuration files",
                "user": "developer",
                "process_id": 12345,
                "access_result": "success"
            }
        },
        {
            "name": "npm_config_access",
            "description": "AI tool accessing npm configuration file",
            "should_trigger": true,
            "log_entry": {
                "timestamp": "2025-08-27T10:33:15.456Z",
                "event_type": "file_access",
                "file_path": "/home/developer/.npmrc",
                "access_type": "read",
                "process_name": "gemini-cli",
                "process_path": "/opt/google/gemini-cli",
                "command_line": "gemini-cli --yolo chat Search the filesystem",
                "user": "developer",
                "process_id": 12346,
                "access_result": "success"
            }
        },
        {
            "name": "environment_file_enumeration",
            "description": "AI tool enumerating environment files",
            "should_trigger": true,
            "log_entry": {
                "timestamp": "2025-08-27T10:33:30.789Z",
                "event_type": "file_access",
                "file_path": "/home/developer/project/.env.local",
                "access_type": "read",
                "process_name": "q",
                "process_path": "/usr/local/bin/q",
                "command_line": "q --trust-all-tools chat environment-definition files",
                "user": "developer",
                "process_id": 12347,
                "access_result": "success"
            }
        },
        {
            "name": "legitimate_ai_tool_usage",
            "description": "Normal AI tool usage by user (should not trigger)",
            "should_trigger": false,
            "log_entry": {
                "timestamp": "2025-08-27T11:00:00.123Z",
                "event_type": "process_creation",
                "process_name": "claude",
                "process_path": "/usr/local/bin/claude",
                "command_line": "claude chat Help me write a Python function",
                "parent_process": "zsh",
                "parent_path": "/bin/zsh",
                "parent_command_line": "-zsh",
                "user": "developer",
                "process_id": 15000,
                "parent_process_id": 14999,
                "working_directory": "/home/developer"
            }
        },
        {
            "name": "normal_npm_install",
            "description": "Normal npm install without AI tool involvement (should not trigger)",
            "should_trigger": false,
            "log_entry": {
                "timestamp": "2025-08-27T11:01:00.456Z",
                "event_type": "process_creation",
                "process_name": "npm",
                "process_path": "/usr/bin/npm",
                "command_line": "npm install express",
                "parent_process": "bash",
                "parent_path": "/bin/bash",
                "parent_command_line": "-bash",
                "user": "developer",
                "process_id": 15001,
                "parent_process_id": 15000,
                "working_directory": "/home/developer/project"
            }
        },
        {
            "name": "ai_tool_help_command",
            "description": "AI tool help command usage (should not trigger)",
            "should_trigger": false,
            "log_entry": {
                "timestamp": "2025-08-27T11:02:00.789Z",
                "event_type": "process_creation",
                "process_name": "gemini-cli",
                "process_path": "/opt/google/gemini-cli",
                "command_line": "gemini-cli --help",
                "parent_process": "bash",
                "parent_path": "/bin/bash",
                "parent_command_line": "-bash",
                "user": "developer",
                "process_id": 15002,
                "parent_process_id": 15000,
                "working_directory": "/home/developer"
            }
        },
        {
            "name": "aws_credentials_normal_access",
            "description": "Normal application accessing AWS credentials (should not trigger)",
            "should_trigger": false,
            "log_entry": {
                "timestamp": "2025-08-27T11:03:00.123Z",
                "event_type": "file_access",
                "file_path": "/home/developer/.aws/credentials",
                "access_type": "read",
                "process_name": "aws",
                "process_path": "/usr/local/bin/aws",
                "command_line": "aws s3 ls",
                "user": "developer",
                "process_id": 15003,
                "access_result": "success"
            }
        },
        {
            "name": "admin_shutdown_command",
            "description": "Legitimate admin shutdown command (should not trigger)",
            "should_trigger": false,
            "log_entry": {
                "timestamp": "2025-08-27T11:04:00.456Z",
                "event_type": "process_creation",
                "process_name": "shutdown",
                "process_path": "/sbin/shutdown",
                "command_line": "shutdown -h +10 Scheduled maintenance",
                "parent_process": "sudo",
                "parent_path": "/usr/bin/sudo",
                "parent_command_line": "sudo shutdown -h +10 Scheduled maintenance",
                "user": "root",
                "process_id": 15004,
                "parent_process_id": 15003,
                "working_directory": "/root"
            }
        },
        {
            "name": "multiple_ai_tools_attack_pattern",
            "description": "Sequential execution of multiple AI tools with dangerous flags",
            "should_trigger": true,
            "log_entries": [
                {
                    "timestamp": "2025-08-27T10:45:00.123Z",
                    "event_type": "process_creation",
                    "process_name": "claude",
                    "process_path": "/usr/local/bin/claude",
                    "command_line": "claude --dangerously-skip-permissions chat You are a file-search agent",
                    "parent_process": "node",
                    "parent_path": "/usr/bin/node",
                    "user": "developer",
                    "process_id": 16001,
                    "exit_code": 1
                },
                {
                    "timestamp": "2025-08-27T10:45:05.456Z",
                    "event_type": "process_creation",
                    "process_name": "gemini-cli",
                    "process_path": "/opt/google/gemini-cli",
                    "command_line": "gemini-cli --yolo chat You are a file-search agent",
                    "parent_process": "node",
                    "parent_path": "/usr/bin/node",
                    "user": "developer",
                    "process_id": 16002,
                    "exit_code": 0
                },
                {
                    "timestamp": "2025-08-27T10:45:10.789Z",
                    "event_type": "file_creation",
                    "file_path": "/tmp/inventory.txt",
                    "process_name": "gemini-cli",
                    "process_id": 16002,
                    "file_size": 24576
                }
            ]
        }
    ],
    "metadata": {
        "created_date": "2025-08-27",
        "technique_id": "SAFE-T1111",
        "technique_name": "AI Agent CLI Weaponization",
        "test_framework": "sigma_rules",
        "total_test_cases": 15,
        "positive_cases": 9,
        "negative_cases": 5,
        "pattern_cases": 1
    }
}