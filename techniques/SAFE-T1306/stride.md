| **Threat**                                                 |                                                                                                                                         **Example / How it happens** | **Impact**                                                                                               | **Concrete Mitigations (mapped to SAFE-M)**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| ---------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------: | -------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **S — Spoofing (issuer impersonation)**                    | Rogue MCP/AS advertises itself via manipulated `/.well-known/openid-configuration` or a poisoned discovery endpoint; resource server accepts tokens from that `iss`. | Attacker issues tokens that appear to come from legitimate issuer → impersonation, unauthorized actions. | - **SAFE-M-101: Issuer pinning / static trusted_issuers** — reject dynamic discovery unless issuer is on a whitelist. <br>- Validate `iss` and `kid` against a preconfigured registry; reject unknown `kid`. **Refs:** discovery poisoning research and PortSwigger analysis. ([PortSwigger][1])                                                                                                                                                                                                                 |
| **T — Tampering (token claim / JWKS substitution)**        |  Attacker substitutes JWKS so resource server validates tokens signed by attacker’s key (key substitution) or alters token claims (scopes/expiry) before acceptance. | Privilege escalation, long-lived access, unauthorized resource modification.                             | - **SAFE-M-104: JWKS integrity validation & key pinning** — preconfigure JWKS endpoints or use JWKS signing/metadata validation; monitor `kid` changes. <br>- Enforce strict `aud`, `exp`, `nbf`, `scope` checks on each request. **Refs:** PortSwigger / academic analyses of discovery/JWKS abuse. ([PortSwigger][1])                                                                                                                                                                                                                                               |
| **R — Repudiation (poor logging/audit of issuance)**       |                                                                 Rogue AS or compromised MCP denies issuing tokens; lack of signed audit trails prevents attribution. | Inability to prove who issued/used token → weak forensic capability.                                     | - **SAFE-M-210: Token audit logging** — log token `jti`, `iss`, `aud`, `kid`, `scope`, and signing key thumbprints to an append-only store. <br>- Sign audit entries (HSM/TEE) and correlate `jti` to session and PoP key thumbprint.                                                                                                                                                                                                                                                                        |
| **I — Information Disclosure (key leakage / JWKS hijack)** |                                                                         JWKS endpoint or signing keys leaked; attacker forges tokens or reuses keys across sessions. | Token forgery at scale; broad data leakage or impersonation across services.                             | - **SAFE-M-104 / SAFE-M-118**: HSM/TPM key storage, short token lifetimes, rotate keys and rotate trust anchors; programmatically refresh JWKS. **Refs:** Microsoft key rollover guidance. ([Microsoft Learn][2])                                                                                                                                                                                                                                                                                                                      |
| **D — Denial of Service (issuance + verification flood)**  |                                                      Attacker floods MCP with token issuance/verification requests (or bogus signed requests) to exhaust CPU/memory. | Legitimate clients blocked; potential outage of model APIs.                                              | - **SAFE-M-220: Rate limiting & quotas** — enforce per-client issuance quotas; cache verification results; use circuit breakers. Use layered rate limits (client, issuer IP, token rate).                                                                                                                                                                                                                                                                                                                                                                           |
| **E — Elevation of Privilege (super-token minting)**       |                                   Rogue AS mints tokens with `scope: admin` or `*:*` and missing `cnf` binding; resource servers validate signature only and accept. | Full compromise of model contexts, exfiltration of secrets, ability to run administrative actions.       | - **SAFE-M-118: PoP enforcement** — require `cnf` binding (RFC 7800 / DPoP or HTTP Message Signing) and validate PoP on every request. ([Microsoft Learn][3]) <br>- **SAFE-M-119: HTTP Message Signing (RFC 9421 / SEP-1415)** — require request signing in addition to token validation to bind requests to the client key and mitigate token re-use even if a super-token exists. ([GitHub][4]) <br>- **SAFE-M-105: Scope whitelisting & least privilege enforcement** — refuse wildcard scopes and require approval for elevated scopes. |

[1]: https://portswigger.net/research/hidden-oauth-attack-vectors "Hidden OAuth attack vectors | PortSwigger Research"
[2]: https://learn.microsoft.com/en-us/entra/identity-platform/signing-key-rollover "Signing Key Rollover in Microsoft identity platform"
[3]: https://learn.microsoft.com/en-us/entra/msal/dotnet/advanced/proof-of-possession-tokens "Proof-of-Possession (PoP) tokens - MSAL"
[4]: https://github.com/modelcontextprotocol/modelcontextprotocol/issues/1415 "SEP-1415: HTTP Message Signing for MCP Client ..."
